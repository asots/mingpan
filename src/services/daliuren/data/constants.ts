/**
 * 大六壬常量數據
 * 
 * 參考來源：
 * - kentang2017/kinliuren (MIT License)
 * - 《大六壬大全》
 * - 《六壬粹言》
 */

import type { TianGan, DiZhi, TianJiangShort, YueJiang, WuXing } from '../types';

// ============================================
// 基礎序列
// ============================================

/** 十天干 */
export const TIAN_GAN: TianGan[] = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];

/** 十二地支 */
export const DI_ZHI: DiZhi[] = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];

/** 十二天將（順序） */
export const TIAN_JIANG: TianJiangShort[] = ['貴', '蛇', '雀', '合', '勾', '龍', '空', '虎', '常', '玄', '陰', '后'];

/** 十二天將全稱 */
export const TIAN_JIANG_FULL: Record<TianJiangShort, string> = {
  '貴': '貴人',
  '蛇': '螣蛇',
  '雀': '朱雀',
  '合': '六合',
  '勾': '勾陳',
  '龍': '青龍',
  '空': '天空',
  '虎': '白虎',
  '常': '太常',
  '玄': '玄武',
  '陰': '太陰',
  '后': '天后',
};

/** 月將名稱對應地支 */
export const YUE_JIANG_MAP: Record<DiZhi, YueJiang> = {
  '亥': '登明',
  '戌': '河魁',
  '酉': '從魁',
  '申': '傳送',
  '未': '小吉',
  '午': '勝光',
  '巳': '太乙',
  '辰': '天罡',
  '卯': '太沖',
  '寅': '功曹',
  '丑': '大吉',
  '子': '神後',
};

// ============================================
// 五行相關
// ============================================

/** 天干五行 */
export const GAN_WUXING: Record<TianGan, WuXing> = {
  '甲': '木', '乙': '木',
  '丙': '火', '丁': '火',
  '戊': '土', '己': '土',
  '庚': '金', '辛': '金',
  '壬': '水', '癸': '水',
};

/** 地支五行 */
export const ZHI_WUXING: Record<DiZhi, WuXing> = {
  '子': '水', '丑': '土',
  '寅': '木', '卯': '木',
  '辰': '土', '巳': '火',
  '午': '火', '未': '土',
  '申': '金', '酉': '金',
  '戌': '土', '亥': '水',
};

/** 五行生剋關係 */
export const WUXING_RELATION: Record<string, string> = {
  // 被尅
  '火水': '被尅', '水土': '被尅', '金火': '被尅', '火金': '尅', '木金': '被尅',
  // 尅
  '水火': '尅', '土水': '尅', '金木': '尅', '木土': '尅',
  // 比和
  '火火': '比和', '水水': '比和', '金金': '比和', '木木': '比和', '土土': '比和',
  // 被生
  '火木': '被生', '水金': '被生', '木水': '被生', '土火': '被生', '金土': '被生',
  // 生
  '木火': '生', '金水': '生', '水木': '生', '火土': '生', '土金': '生',
};

/** 六親對應 */
export const LIUQIN_MAP: Record<string, string> = {
  '被生': '父母',
  '生': '子孫',
  '尅': '妻財',
  '比和': '兄弟',
  '被尅': '官鬼',
};

// ============================================
// 日干寄宮
// ============================================

/** 日干寄宮（天干寄於地支） */
export const GAN_JI_GONG: Record<TianGan, DiZhi> = {
  '甲': '寅',
  '乙': '辰',
  '丙': '巳',
  '丁': '未',
  '戊': '巳',
  '己': '未',
  '庚': '申',
  '辛': '戌',
  '壬': '亥',
  '癸': '丑',
};

// ============================================
// 月將（節氣對應）
// ============================================

/** 節氣對應月將 */
export const JIEQI_YUE_JIANG: Record<string, DiZhi> = {
  // 雨水、驚蟄 -> 亥（登明）
  '雨水': '亥', '驚蟄': '亥',
  // 春分、清明 -> 戌（河魁）
  '春分': '戌', '清明': '戌',
  // 穀雨、立夏 -> 酉（從魁）
  '穀雨': '酉', '立夏': '酉',
  // 小滿、芒種 -> 申（傳送）
  '小滿': '申', '芒種': '申',
  // 夏至、小暑 -> 未（小吉）
  '夏至': '未', '小暑': '未',
  // 大暑、立秋 -> 午（勝光）
  '大暑': '午', '立秋': '午',
  // 處暑、白露 -> 巳（太乙）
  '處暑': '巳', '白露': '巳',
  // 秋分、寒露 -> 辰（天罡）
  '秋分': '辰', '寒露': '辰',
  // 霜降、立冬 -> 卯（太沖）
  '霜降': '卯', '立冬': '卯',
  // 小雪、大雪 -> 寅（功曹）
  '小雪': '寅', '大雪': '寅',
  // 冬至、小寒 -> 丑（大吉）
  '冬至': '丑', '小寒': '丑',
  // 大寒、立春 -> 子（神後）
  '大寒': '子', '立春': '子',
};

// ============================================
// 貴人起點
// ============================================

/** 
 * 貴人起點（晝夜）
 * 甲戊庚牛羊，乙己鼠猴鄉，丙丁豬雞位，壬癸蛇兔藏，六辛逢馬虎
 */
export const GUIREN_START: Record<string, { day: DiZhi; night: DiZhi }> = {
  '甲': { day: '丑', night: '未' },
  '戊': { day: '丑', night: '未' },
  '庚': { day: '丑', night: '未' },
  '乙': { day: '子', night: '申' },
  '己': { day: '子', night: '申' },
  '丙': { day: '亥', night: '酉' },
  '丁': { day: '亥', night: '酉' },
  '壬': { day: '巳', night: '卯' },
  '癸': { day: '巳', night: '卯' },
  '辛': { day: '午', night: '寅' },
};

/** 晝夜判斷（時辰） */
export const DAY_NIGHT_MAP: Record<DiZhi, '晝' | '夜'> = {
  '卯': '晝', '辰': '晝', '巳': '晝', '午': '晝', '未': '晝', '申': '晝',
  '酉': '夜', '戌': '夜', '亥': '夜', '子': '夜', '丑': '夜', '寅': '夜',
};

// ============================================
// 旬空
// ============================================

/** 六甲旬空 */
export const XUN_KONG: Record<string, [DiZhi, DiZhi]> = {
  '甲子': ['戌', '亥'],
  '甲戌': ['申', '酉'],
  '甲申': ['午', '未'],
  '甲午': ['辰', '巳'],
  '甲辰': ['寅', '卯'],
  '甲寅': ['子', '丑'],
};

/** 六十甲子 */
export const JIA_ZI_60: string[] = (() => {
  const result: string[] = [];
  for (let i = 0; i < 60; i++) {
    result.push(TIAN_GAN[i % 10] + DI_ZHI[i % 12]);
  }
  return result;
})();

// ============================================
// 地支關係
// ============================================

/** 地支相沖 */
export const ZHI_CHONG: Record<DiZhi, DiZhi> = {
  '子': '午', '午': '子',
  '丑': '未', '未': '丑',
  '寅': '申', '申': '寅',
  '卯': '酉', '酉': '卯',
  '辰': '戌', '戌': '辰',
  '巳': '亥', '亥': '巳',
};

/** 地支相刑 */
export const ZHI_XING: Record<DiZhi, DiZhi> = {
  '寅': '巳', '巳': '申', '申': '寅',  // 無恩之刑
  '丑': '戌', '戌': '未', '未': '丑',  // 恃勢之刑
  '子': '卯', '卯': '子',              // 無禮之刑
  '辰': '辰', '午': '午', '酉': '酉', '亥': '亥',  // 自刑
};

/** 地支六合 */
export const ZHI_HE: Record<DiZhi, DiZhi> = {
  '子': '丑', '丑': '子',
  '寅': '亥', '亥': '寅',
  '卯': '戌', '戌': '卯',
  '辰': '酉', '酉': '辰',
  '巳': '申', '申': '巳',
  '午': '未', '未': '午',
};

/** 地支相害 */
export const ZHI_HAI: Record<DiZhi, DiZhi> = {
  '子': '未', '未': '子',
  '丑': '午', '午': '丑',
  '寅': '巳', '巳': '寅',
  '卯': '辰', '辰': '卯',
  '申': '亥', '亥': '申',
  '酉': '戌', '戌': '酉',
};

// ============================================
// 驛馬
// ============================================

/** 日馬（根據日支） */
export const RI_MA: Record<DiZhi, DiZhi> = {
  '子': '寅', '丑': '亥', '寅': '申', '卯': '巳',
  '辰': '寅', '巳': '亥', '午': '申', '未': '巳',
  '申': '寅', '酉': '亥', '戌': '申', '亥': '巳',
};

/** 月馬（根據日支） */
export const YUE_MA_MAP: Record<string, DiZhi> = {
  '寅申': '午', '卯酉': '申', '辰戌': '戌',
  '巳亥': '子', '午子': '寅', '丑未': '辰',
};

// ============================================
// 八專日
// ============================================

/** 八專日干支 */
export const BA_ZHUAN_DAYS = ['壬子', '甲寅', '乙卯', '丁巳', '己未', '庚申', '辛酉', '癸亥'];

/** 日干支同位 */
export const GAN_ZHI_SAME_POSITION = ['甲寅', '丁未', '己未', '庚申', '癸丑'];
